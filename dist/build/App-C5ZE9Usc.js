const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["ConfigureTheView-CNeCMPrC.js","strapi-DkLPdG7R.js","strapi-D6821bIJ.css"])))=>i.map(i=>d[i]);
import{a as v,w as $e,ch as De,cd as Be,ck as Ue,eY as z,cs as r,j as e,$ as w,H as $,dh as Pe,dk as Ve,dl as ze,f as F,fB as it,fC as Se,fD as ot,r as y,di as dt,T as te,dm as lt,dp as rt,dn as ct,fE as ut,M as U,aX as Fe,ct as ke,l as A,fF as Qe,fG as pt,bI as ee,I as H,bB as Oe,bJ as He,cz as p,h as Ge,fH as gt,fI as ht,dj as X,fJ as Q,fK as ft,fL as xt,fM as Z,fN as mt,fO as jt,eF as yt,cc as Ct,fP as bt,fQ as Ne,fR as vt,D as k,d9 as At,fS as Mt,bE as We,cq as wt,cp as St,fT as G,fU as Ft,fV as kt,L as It,bt as Tt,bu as Et,fW as Lt,fX as Rt,ff as _t,fY as $t,fZ as Dt,f_ as Bt,aJ as pe,u as se,dG as Ie,f$ as Ut,g0 as Pt,g1 as Te,g2 as Vt,aO as qe,C as Y,bV as zt,aQ as Je,aI as Qt,eD as Ot,g3 as Ht,V as Gt,b as Nt,g4 as Wt,g5 as qt,g6 as Jt,g7 as Xt,g8 as Zt,g9 as Kt,P,a3 as Yt,cD as es,ga as ts,gb as ss,gc as K,gd as as,ge as ns,gf as is,gg as os,gh as ds,gi as ls,bF as rs,bm as cs,gj as us,cS as ue,gk as ps,gl as gs,gm as hs,gn as fs,e_ as xs,R as ms,Q as Ee,_ as js}from"./strapi-DkLPdG7R.js";import{S as ys}from"./SearchInput-CMDMf42F.js";const Cs=()=>{const{formatMessage:t}=v(),{toggleNotification:n}=$e(),s=De(),{post:a}=Be(),o=Ue(({updates:g})=>a("/upload/actions/bulk-update",{updates:g}),{onSuccess(g){const{data:m}=g;m&&m.length>0&&(s.refetchQueries([z,"assets"],{active:!0}),s.refetchQueries([z,"asset-count"],{active:!0}),s.refetchQueries([z,"folders"],{active:!0})),n({type:"success",message:t({id:r("modal.edit.success-label"),defaultMessage:"Files have been successfully updated."})})}});return{...o,edit:g=>o.mutateAsync({updates:g})}},Xe=A(mt)`
  opacity: 0;
  z-index: 1;

  &:focus-within {
    opacity: 1;
  }
`,bs=A(w)`
  background: ${({theme:t})=>t.colors.neutral0};
  border: 1px solid ${({theme:t})=>t.colors.neutral150};
  border-radius: ${({theme:t})=>t.borderRadius};

  &:hover {
    ${Xe} {
      opacity: 1;
    }
  }
`,vs=({asset:t})=>{const{formatMessage:n}=v(),s=O("AssetCardActions",i=>i.dispatch),a=O("AssetCardActions",i=>i.state),l=O("AssetCardActions",i=>i.onClose),{canUpdate:o,canCopyLink:u,canDownload:g}=Qe(),[m,h]=y.useState(!1),{removeAsset:j}=pt(()=>{}),f=async i=>{i?.preventDefault(),await j(t.id),s({type:"remove_uploaded_asset",payload:{id:t.id}}),a.uploadedAssets.length===1&&l()},x=i=>{i.stopPropagation()},M=i=>{i&&(s({type:"edit_uploaded_asset",payload:{editedAsset:i}}),h(!1))};return e.jsxs(Xe,{onClick:x,position:"end",children:[e.jsxs(ee.Root,{children:[e.jsx(ee.Trigger,{children:e.jsx(H,{label:n({id:r("control-card.remove-selection"),defaultMessage:"Remove from selection"}),children:e.jsx(Oe,{})})}),e.jsx(He,{onConfirm:f})]}),e.jsxs(p.Root,{open:m,onOpenChange:h,children:[e.jsx(p.Trigger,{children:e.jsx(H,{label:n({id:r("control-card.edit"),defaultMessage:"Edit"}),children:e.jsx(Ge,{})})}),e.jsx(p.Content,{children:e.jsx(gt,{asset:{...t,isLocal:!1,folder:typeof t.folder=="number"?{id:t.folder}:t.folder},onClose:i=>M(i),canUpdate:o,canCopyLink:u,canDownload:g,omitFields:["caption","alternativeText"],omitActions:["replace"]})})]})]})},As=A.span`
  text-transform: uppercase;
`,Ms=A(w)`
  position: relative;
  height: 100%;
  overflow: hidden;

  canvas,
  video {
    display: block;
    pointer-events: none;
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: ${({theme:t})=>t.borderRadius};
  }
`,ws=A(jt)`
  position: absolute;
  bottom: 0.5rem;
  right: 0.5rem;
`,Ss=A(w)`
  height: 100%;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;

  canvas,
  audio {
    display: block;
    max-width: 100%;
    max-height: 100%;
  }
`,Fs=({assetType:t,thumbnailUrl:n,assetUrl:s,asset:a})=>{const[l,o]=y.useState(),u=l?ht(l):void 0;switch(t){case Q.Image:return e.jsx(X,{src:n,size:"S",alt:a.alternativeText||a.name});case Q.Video:return e.jsx(X,{size:"S",children:e.jsxs(Ms,{children:[e.jsx(xt,{url:s,mime:a.mime||"video/mp4",onLoadDuration:o,alt:a.alternativeText||a.name}),u&&e.jsx(ws,{children:u})]})});case Q.Audio:return e.jsx(X,{size:"S",children:e.jsx(Ss,{children:e.jsx(ft,{url:s,alt:a.alternativeText||a.name})})});default:return e.jsx(X,{src:n,size:"S",alt:a.alternativeText||a.name})}},ks=A(Ve)`
  display: flex;
  padding: ${({theme:t})=>t.spaces[2]} ${({theme:t})=>t.spaces[1]};
`,Is=A(Pe)`
  width: 100%;
  height: 100%;
  border: none;
  box-shadow: none;
  border-radius: 0;
  padding: 0;
`,Ts=t=>{switch(t){case Q.Image:return{id:r("settings.section.image.label"),defaultMessage:"IMAGE"};case Q.Video:return{id:r("settings.section.video.label"),defaultMessage:"VIDEO"};case Q.Audio:return{id:r("settings.section.audio.label"),defaultMessage:"AUDIO"};case Z.Pdf:return{id:r("settings.section.pdf.label"),defaultMessage:"PDF"};case Z.Csv:return{id:r("settings.section.csv.label"),defaultMessage:"CSV"};case Z.Xls:return{id:r("settings.section.xls.label"),defaultMessage:"XLS"};case Z.Zip:return{id:r("settings.section.zip.label"),defaultMessage:"ZIP"};default:return{id:r("settings.section.doc.label"),defaultMessage:"DOC"}}},Es=({asset:t,onCaptionChange:n,onAltTextChange:s,wasAltTextChanged:a,wasCaptionChanged:l})=>{const{formatMessage:o}=v(),u=it(t.mime||""),g=Se(t?.formats?.thumbnail?.url||t.url)||"",m=Se(t.url)||"",h=t.height&&t.width?` - ${t.width}x${t.height}`:"",j=t.size?ot(t.size):"",f=`${h}${h&&j?" - ":""}${j}`,[x,M]=y.useState(t.caption||"");y.useEffect(()=>{n(x)},[x,n]);const[i,I]=y.useState(t.alternativeText||"");return y.useEffect(()=>{s(i)},[i,s]),e.jsx(bs,{children:e.jsxs($.Root,{children:[e.jsx($.Item,{col:5,alignItems:"stretch",children:e.jsxs(Is,{width:"100%",height:"100%",shadow:"none",borderRadius:0,padding:0,children:[e.jsxs(dt,{style:{borderStyle:"none"},children:[e.jsx(vs,{asset:t}),e.jsx(Fs,{assetType:u,thumbnailUrl:g,assetUrl:m,asset:t})]}),e.jsx(ks,{children:e.jsxs(ze,{width:"100%",children:[e.jsxs(F,{justifyContent:"space-between",alignItems:"start",children:[e.jsx(te,{tag:"h2",children:e.jsx(lt,{tag:"span",children:t.name})}),e.jsx(rt,{children:o(Ts(u))})]}),e.jsx(F,{children:e.jsxs(ct,{children:[e.jsx(As,{children:ut(t.ext)}),f]})})]})})]})}),e.jsx($.Item,{col:7,flex:1,children:e.jsxs(F,{direction:"column",height:"100%",alignItems:"stretch",flex:1,padding:4,gap:2,children:[e.jsxs(U.Root,{name:"caption",children:[e.jsx(F,{alignItems:"center",gap:2,children:e.jsx(U.Label,{children:o({id:r("form.input.label.file-caption"),defaultMessage:"Caption"})})}),e.jsx(Fe,{value:x,onChange:S=>M(S.target.value),placeholder:o({id:r("form.input.placeholder.file-caption"),defaultMessage:"Enter caption"}),endAction:!l&&t.caption&&e.jsx(ke,{width:"16px",height:"16px",fill:"#AC73E6"}),type:"text"})]}),e.jsxs(U.Root,{name:"alternativeText",hint:o({id:r("form.input.description.file-alt"),defaultMessage:"This text will be displayed if the asset can't be shown."}),children:[e.jsx(F,{alignItems:"center",gap:2,children:e.jsx(U.Label,{children:o({id:r("form.input.label.file-alt"),defaultMessage:"Alternative text"})})}),e.jsx(Fe,{value:i,onChange:S=>I(S.target.value),placeholder:o({id:r("form.input.placeholder.file-alt"),defaultMessage:"Enter alternative text"}),endAction:!a&&t.alternativeText&&e.jsx(ke,{width:"16px",height:"16px",fill:"#AC73E6"}),type:"text"}),e.jsx(U.Hint,{})]})]})})]})})},_=A(w)`
  background: linear-gradient(
    90deg,
    ${({theme:t})=>t.colors.neutral100} 25%,
    ${({theme:t})=>t.colors.neutral150} 50%,
    ${({theme:t})=>t.colors.neutral100} 75%
  );
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
  border-radius: ${({theme:t})=>t.borderRadius};
  width: ${({width:t})=>t||"100%"};
  height: ${({height:t})=>t||"1rem"};

  @keyframes loading {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }
`,Ls=({count:t=1})=>Array.from({length:t},(s,a)=>a).map(s=>e.jsx(w,{background:"neutral0",borderColor:"neutral150",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",marginBottom:4,children:e.jsxs($.Root,{children:[e.jsx($.Item,{col:5,alignItems:"stretch",children:e.jsxs(Pe,{height:"100%",width:"100%",borderStyle:"none",shadow:"none",borderRadius:0,padding:2,children:[e.jsx(w,{height:"150px",padding:2,children:e.jsx(_,{height:"100%"})}),e.jsx(Ve,{style:{display:"flex",padding:"8px 4px"},children:e.jsxs(ze,{width:"100%",children:[e.jsxs(F,{justifyContent:"space-between",alignItems:"start",marginBottom:1,children:[e.jsx(_,{width:"60%",height:"18px"}),e.jsx(_,{width:"40px",height:"16px"})]}),e.jsx(_,{width:"80%",height:"14px"})]})})]})}),e.jsx($.Item,{col:7,flex:1,children:e.jsxs(F,{direction:"column",height:"100%",alignItems:"stretch",flex:1,padding:4,gap:2,children:[e.jsxs(w,{children:[e.jsx(_,{width:"60px",height:"16px",marginBottom:1}),e.jsx(_,{height:"32px"})]}),e.jsxs(w,{children:[e.jsx(_,{width:"100px",height:"16px",marginBottom:1}),e.jsx(_,{height:"32px"}),e.jsx(w,{marginTop:1,children:e.jsx(_,{width:"70%",height:"12px"})})]})]})})]})},s)),Le=A(p.Body)`
  padding: 0;
  display: flex;
  justify-content: center;

  [data-radix-scroll-area-viewport] {
    padding-top: ${({theme:t})=>t.spaces[6]};
    padding-bottom: ${({theme:t})=>t.spaces[6]};
    padding-left: ${({theme:t})=>t.spaces[7]};
    padding-right: ${({theme:t})=>t.spaces[7]};
  }
`,Rs=A(At)`
  & > button {
    display: none;
  }
`,_s=({onClose:t})=>{const{formatMessage:n}=v(),s=O("ModalContent",c=>c.state),a=O("ModalContent",c=>c.dispatch),l=O("ModalContent",c=>c.folderId),{upload:o}=bt(),{edit:u,isLoading:g}=Cs(),[m,h]=y.useState(!1),[j,f]=y.useState(null),{trackUsage:x}=Ne(),M=(c,C)=>{a({type:"set_uploaded_asset_caption",payload:{id:c,caption:C}})},i=(c,C)=>{a({type:"set_uploaded_asset_alt_text",payload:{id:c,altText:C}})},I=()=>{a({type:"set_uploaded_assets",payload:[]})},S=async()=>{if(s.hasUnsavedChanges){const c=s.uploadedAssets.filter(C=>(C.wasCaptionChanged||C.wasAltTextChanged)&&C.file.id);if(c.length>0){c.some(b=>b.wasCaptionChanged)&&x("didEditAICaption"),c.some(b=>b.wasAltTextChanged)&&x("didEditAIAlternativeText");const C=c.map(b=>({id:b.file.id,fileInfo:{name:b.file.name,alternativeText:b.file.alternativeText??null,caption:b.file.caption??null,folder:typeof b.file.folder=="object"&&b.file.folder!==null?b.file.folder.id:b.file.folder}}));try{await u(C),a({type:"clear_unsaved_changes"})}catch(b){console.error("Failed to save asset changes:",b);return}}}I(),t()},N=()=>{I(),t()},ae=async c=>{a({type:"set_assets_to_upload_length",payload:c.length}),f(null),h(!0);try{const C=c.map(D=>({...D,id:D.id?Number(D.id):void 0})),B=(await o(C,l)).map(D=>({...D,folder:l||D.folder}));a({type:"set_uploaded_assets",payload:B})}catch(C){console.error("Upload failed:",C),f(C instanceof Error?C:new Error("Upload failed"))}finally{h(!1)}};if(s.assetsToUploadLength===0)return e.jsx(p.Content,{children:e.jsx(vt,{onClose:t,onAddAsset:ae})});if(m||s.assetsToUploadLength>0&&s.uploadedAssets.length===0&&!j)return e.jsxs(p.Content,{children:[e.jsx(p.Header,{children:e.jsx(p.Title,{children:n({id:r("ai.modal.uploading.title"),defaultMessage:"Uploading and processing with AI..."})})}),e.jsx(Le,{children:e.jsx(Ls,{count:s.assetsToUploadLength})})]});const L=n({id:r("ai.modal.title"),defaultMessage:"{count, plural, one {# asset uploaded} other {# assets uploaded}}, review AI generated metadata"},{count:s.uploadedAssets.length});return j?e.jsxs(p.Content,{children:[e.jsx(p.Header,{children:e.jsx(p.Title,{children:L})}),e.jsx(p.Body,{children:e.jsx(Rs,{closeLabel:"",variant:"danger",children:n({id:r("ai.modal.error"),defaultMessage:"Could not generate AI metadata for the uploaded files."})})}),e.jsxs(p.Footer,{children:[e.jsx(k,{onClick:N,variant:"tertiary",children:n({id:"cancel",defaultMessage:"Cancel"})}),e.jsx(k,{onClick:S,loading:g,children:n({id:"global.finish",defaultMessage:"Finish"})})]})]}):e.jsxs(p.Content,{children:[e.jsx(p.Header,{children:e.jsx(p.Title,{children:L})}),e.jsx(Le,{children:e.jsx(F,{gap:6,direction:"column",alignItems:"stretch",children:s.uploadedAssets.map(({file:c,wasCaptionChanged:C,wasAltTextChanged:b})=>e.jsx(Es,{asset:c,onCaptionChange:B=>c.id&&M(c.id,B),onAltTextChange:B=>c.id&&i(c.id,B),wasCaptionChanged:C,wasAltTextChanged:b},c.id))})}),e.jsxs(p.Footer,{children:[e.jsx(k,{onClick:N,variant:"tertiary",children:n({id:"cancel",defaultMessage:"Cancel"})}),e.jsx(k,{onClick:S,loading:g,children:n({id:"global.finish",defaultMessage:"Finish"})})]})]})},[$s,O]=yt("AIUploadModalContext"),Ds=(t,n)=>Ct(t,s=>{if(n.type==="set_uploaded_assets"&&(s.uploadedAssets=n.payload.map(a=>({file:a,wasCaptionChanged:!1,wasAltTextChanged:!1})),s.hasUnsavedChanges=!1),n.type==="set_assets_to_upload_length"&&(s.assetsToUploadLength=n.payload),n.type==="set_uploaded_asset_caption"){const a=s.uploadedAssets.find(l=>l.file.id===n.payload.id);a&&a.file.caption!==n.payload.caption&&(a.file.caption=n.payload.caption,a.wasCaptionChanged=!0,s.hasUnsavedChanges=!0)}if(n.type==="set_uploaded_asset_alt_text"){const a=s.uploadedAssets.find(l=>l.file.id===n.payload.id);a&&a.file.alternativeText!==n.payload.altText&&(a.file.alternativeText=n.payload.altText,a.wasAltTextChanged=!0,s.hasUnsavedChanges=!0)}if(n.type==="remove_uploaded_asset"&&(s.uploadedAssets=s.uploadedAssets.filter(a=>a.file.id!==n.payload.id)),n.type==="edit_uploaded_asset"){const a=s.uploadedAssets.findIndex(l=>l.file.id===n.payload.editedAsset.id);a!==-1&&(s.uploadedAssets[a]={file:n.payload.editedAsset,wasCaptionChanged:s.uploadedAssets[a].wasCaptionChanged,wasAltTextChanged:s.uploadedAssets[a].wasAltTextChanged})}n.type==="clear_unsaved_changes"&&(s.hasUnsavedChanges=!1,s.uploadedAssets.forEach(a=>{a.wasCaptionChanged=!1,a.wasAltTextChanged=!1}))}),Bs=({open:t,onClose:n,folderId:s=null})=>{const[a,l]=y.useReducer(Ds,{uploadedAssets:[],assetsToUploadLength:0,hasUnsavedChanges:!1}),o=y.useCallback(()=>{l({type:"set_uploaded_assets",payload:[]}),n()},[n]);return e.jsx($s,{state:a,dispatch:l,folderId:s,onClose:o,children:e.jsx(p.Root,{open:t,onOpenChange:o,children:e.jsx(_s,{onClose:o})})})},Us=t=>{const{id:n}=Mt();return e.jsx(w,{position:"relative",zIndex:2,children:e.jsx(We,{"aria-labelledby":`${n}-title`,...t})})},Ps=()=>{const t=wt(),{status:n,data:s}=St(t);return t?{status:n,isEnabled:s?.aiMetadata}:{status:"success",isEnabled:!1}},Vs=(t,{pathname:n,query:s})=>{const a=[{id:null,label:{id:r("plugin.name"),defaultMessage:"Media Library"},href:t?G(n,s||{}):void 0}];return t?.parent&&typeof t?.parent!="number"&&t?.parent?.parent&&a.push([]),t?.parent&&typeof t.parent!="number"&&a.push({id:t.parent.id,label:t.parent.name,href:G(n,s||{},{folder:t.parent.id?.toString(),folderPath:t.parent.path})}),t&&a.push({id:t.id,label:t.name}),a},zs=({selected:t,onSuccess:n})=>{const{formatMessage:s}=v(),{remove:a}=Ft(),l=async()=>{await a(t),n()};return e.jsxs(ee.Root,{children:[e.jsx(ee.Trigger,{children:e.jsx(k,{variant:"danger-light",size:"S",startIcon:e.jsx(Oe,{}),children:s({id:"global.delete",defaultMessage:"Delete"})})}),e.jsx(He,{onConfirm:l})]})},Qs=()=>{const{formatMessage:t}=v(),{toggleNotification:n}=$e(),s=De(),{post:a}=Be(),o=Ue(({destinationFolderId:g,filesAndFolders:m})=>{const h=m.reduce((j,f)=>{const{id:x,type:M}=f,i=M==="asset"?"fileIds":"folderIds";return j[i]||(j[i]=[]),j[i].push(x),j},{});return a("/upload/actions/bulk-move",{...h,destinationFolderId:g})},{onSuccess(g){const{data:{data:m}}=g;m?.files?.length>0&&(s.refetchQueries([z,"assets"],{active:!0}),s.refetchQueries([z,"asset-count"],{active:!0})),s.refetchQueries([z,"folders"],{active:!0}),n({type:"success",message:t({id:r("modal.move.success-label"),defaultMessage:"Elements have been moved successfully."})})}});return{...o,move:(g,m)=>o.mutateAsync({destinationFolderId:g,filesAndFolders:m})}},Os=({onClose:t,selected:n=[],currentFolder:s})=>{const{formatMessage:a}=v(),{data:l,isLoading:o}=kt(),{move:u}=Qs();if(!l)return null;const g=async(h,{setErrors:j})=>{try{if(typeof h.destination!="string"){const f=h.destination.value;await u(f,n),t()}}catch(f){const x=Rt(f);if(x&&"errors"in x){const M=x.errors?.reduce((i,I)=>(i[I.values?.path?.length||"destination"]=I.defaultMessage,i),{});_t(M)||j(M)}}};if(o)return e.jsx(p.Content,{children:e.jsx(p.Body,{children:e.jsx(F,{justifyContent:"center",paddingTop:4,paddingBottom:4,children:e.jsx(It,{children:a({id:r("content.isLoading"),defaultMessage:"Content is loading."})})})})});const m={destination:{value:s?.id||"",label:s?.name||l[0].label}};return e.jsx(p.Content,{children:e.jsx(Tt,{validateOnChange:!1,onSubmit:g,initialValues:m,children:({values:h,errors:j,setFieldValue:f})=>e.jsxs(Et,{noValidate:!0,children:[e.jsx(p.Header,{children:e.jsx(p.Title,{children:a({id:r("modal.folder.move.title"),defaultMessage:"Move elements to"})})}),e.jsx(p.Body,{children:e.jsx($.Root,{gap:4,children:e.jsx($.Item,{xs:12,col:12,direction:"column",alignItems:"stretch",children:e.jsxs(U.Root,{id:"folder-destination",children:[e.jsx(U.Label,{children:a({id:r("form.input.label.folder-location"),defaultMessage:"Location"})}),e.jsx(Lt,{options:l,onChange:x=>{f("destination",x)},defaultValue:typeof h.destination!="string"?h.destination:void 0,name:"destination",menuPortalTarget:document.querySelector("body"),inputId:"folder-destination",error:j?.destination,ariaErrorMessage:"destination-error"}),j.destination&&e.jsx(te,{variant:"pi",tag:"p",textColor:"danger600",children:j.destination})]})})})}),e.jsxs(p.Footer,{children:[e.jsx(p.Close,{children:e.jsx(k,{variant:"tertiary",name:"cancel",children:a({id:"cancel",defaultMessage:"Cancel"})})}),e.jsx(k,{type:"submit",loading:o,children:a({id:"modal.folder.move.submit",defaultMessage:"Move"})})]})]})})})},Hs=({selected:t=[],onSuccess:n,currentFolder:s})=>{const{formatMessage:a}=v(),[l,o]=y.useState(!1),u=()=>{o(!1),n()};return e.jsxs(p.Root,{open:l,onOpenChange:o,children:[e.jsx(p.Trigger,{children:e.jsx(k,{variant:"secondary",size:"S",startIcon:e.jsx($t,{}),children:a({id:"global.move",defaultMessage:"Move"})})}),e.jsx(Os,{currentFolder:s,onClose:u,selected:t})]})},Gs=({selected:t=[],onSuccess:n,currentFolder:s})=>{const{formatMessage:a}=v(),l=t?.reduce(function(o,u){return u?.type==="folder"&&"files"in u&&u?.files&&"count"in u.files?o+u?.files?.count:o+1},0);return e.jsxs(F,{gap:2,paddingBottom:5,children:[e.jsx(te,{variant:"epsilon",textColor:"neutral600",children:a({id:r("list.assets.selected"),defaultMessage:"{numberFolders, plural, one {1 folder} other {# folders}} - {numberAssets, plural, one {1 asset} other {# assets}} selected"},{numberFolders:t?.filter(({type:o})=>o==="folder").length,numberAssets:l})}),e.jsx(zs,{selected:t,onSuccess:n}),e.jsx(Hs,{currentFolder:s,selected:t,onSuccess:n})]})},Ns=({isFiltering:t,canCreate:n,canRead:s})=>t?{id:"list.assets-empty.title-withSearch",defaultMessage:"There are no elements with the applied filters"}:s?n?{id:"list.assets.empty-upload",defaultMessage:"Upload your first assets..."}:{id:"list.assets.empty",defaultMessage:"Media Library is empty"}:{id:"header.actions.no-permissions",defaultMessage:"No permissions to view"},Ws=({canCreate:t,isFiltering:n,canRead:s,onActionClick:a})=>{const{formatMessage:l}=v(),o=Ns({isFiltering:n,canCreate:t,canRead:s});return e.jsx(Dt,{icon:s?void 0:Bt,action:t&&!n&&e.jsx(k,{variant:"secondary",startIcon:e.jsx(pe,{}),onClick:a,children:l({id:r("header.actions.add-assets"),defaultMessage:"Add new assets"})}),content:l({...o,id:r(o.id)})})},qs=()=>{const[t,n]=y.useState(!1),{formatMessage:s}=v(),{trackUsage:a}=Ne(),[{query:l},o]=se(),u=l?.filters?.$and||[],g=h=>{o({filters:{$and:h},page:1})},m=h=>{a("didFilterMediaLibraryElements",{location:"content-manager",filter:Object.keys(h[h.length-1])[0]}),o({filters:{$and:h},page:1})};return e.jsxs(Ie.Root,{open:t,onOpenChange:n,children:[e.jsx(Ie.Trigger,{children:e.jsx(k,{variant:"tertiary",startIcon:e.jsx(Ut,{}),size:"S",children:s({id:"app.utils.filters",defaultMessage:"Filters"})})}),e.jsx(Pt,{displayedFilters:Te,filters:u,onSubmit:m,onToggle:n}),e.jsx(Vt,{appliedFilters:u,filtersSchema:Te,onRemoveFilter:g})]})},Js=({breadcrumbs:t=null,canCreate:n,folder:s=null,onToggleEditFolderDialog:a,onToggleUploadAssetDialog:l})=>{const{formatMessage:o}=v(),{pathname:u}=qe(),[{query:g}]=se(),m={...g,folder:s?.parent&&typeof s.parent!="number"&&s.parent.id?s.parent.id:void 0,folderPath:s?.parent&&typeof s.parent!="number"&&s.parent.path?s.parent.path:void 0};return e.jsx(Y.Header,{title:o({id:r("plugin.name"),defaultMessage:"Media Library"}),subtitle:t&&typeof t!="boolean"&&s&&e.jsx(Ht,{label:o({id:r("header.breadcrumbs.nav.label"),defaultMessage:"Folders navigation"}),breadcrumbs:t,currentFolderId:s?.id}),navigationAction:s&&e.jsx(zt,{tag:Qt,startIcon:e.jsx(Ot,{}),to:`${u}?${Je.stringify(m,{encode:!1})}`,children:o({id:r("header.actions.folder-level-up"),defaultMessage:"Back"})}),primaryAction:n&&e.jsxs(F,{gap:2,children:[e.jsx(k,{startIcon:e.jsx(pe,{}),variant:"secondary",onClick:a,children:o({id:r("header.actions.add-folder"),defaultMessage:"Add new folder"})}),e.jsx(k,{startIcon:e.jsx(pe,{}),onClick:l,children:o({id:r("header.actions.add-assets"),defaultMessage:"Add new assets"})})]})})},Xs=A(w)`
  height: 3.2rem;
  display: flex;
  align-items: center;
`,Re=A(te)`
  max-width: 100%;
`,_e=A(w)`
  svg {
    path {
      fill: ${({theme:t})=>t.colors.neutral500};
    }
  }
`,Zs=()=>{const t=Gt(),{canRead:n,canCreate:s,canUpdate:a,canCopyLink:l,canDownload:o,canConfigureView:u,isLoading:g}=Qe(),{isEnabled:m,status:h}=Ps(),j=y.useRef(),{formatMessage:f}=v(),{pathname:x}=qe(),{trackUsage:M}=Nt(),[{query:i},I]=se(),S=!!(i._q||i.filters),[N,ae]=Wt(fs.view,K.GRID),L=N===K.GRID,{data:c,isLoading:C,error:b}=qt({skipWhen:!n,query:i}),{data:B,isLoading:D,error:Ze}=Jt({enabled:n&&c?.pagination?.page===1&&!Xt(i),query:i}),{data:ne,isLoading:ge,error:Ke}=Zt(i?.folder,{enabled:n&&!!i?.folder});Ke?.name==="NotFoundError"&&t(x);const W=B?.map(d=>({...d,type:"folder",folderURL:G(x,i,{folder:d.id.toString(),folderPath:d.path}),isSelectable:a}))??[],T=W?.length||0,q=c?.results?.map(d=>({...d,type:"asset",isSelectable:a}))||[],E=q?.length??0,Ye=c?.pagination?.total,et=ge||D||g||C||h==="loading",[ie,tt]=y.useState(!1),[he,fe]=y.useState(!1),[oe,de]=y.useState(void 0),[le,xe]=y.useState(void 0),[R,{selectOne:re,selectAll:me,setSelections:je}]=Kt(["type","id"],[]);y.useEffect(()=>{je([])},[i.folder,je]);const ye=R?.length>0&&R?.length!==E+T,J=()=>tt(d=>!d),Ce=({created:d=!1}={})=>{d&&i?.page!=="1"&&I({...i,page:1}),fe(V=>!V)},be=(d,V)=>{d&&M("didSelectAllMediaLibraryElements"),me(V)},ve=d=>{M("didSortMediaLibraryElements",{location:"upload",sort:d}),I({sort:d})},Ae=d=>{xe(d),fe(!0)},st=d=>{xe(null),Ce(d),j.current&&j.current.focus()},Me=d=>{d===E&&c?.pagination?.page===c?.pagination?.pageCount&&c?.pagination?.page&&c.pagination.page>1&&I({...i,page:c.pagination.page-1})},at=()=>{me(),Me(R.length)};return et?e.jsx(P.Loading,{}):b||Ze||h==="error"?e.jsx(P.Error,{}):e.jsxs(Y.Root,{children:[e.jsxs(P.Main,{children:[e.jsx(Js,{breadcrumbs:ge?null:Vs(ne,{pathname:x,query:i}),canCreate:s,onToggleEditFolderDialog:Ce,onToggleUploadAssetDialog:J,folder:ne}),e.jsx(Y.Action,{startActions:e.jsxs(e.Fragment,{children:[a&&L&&(E>0||T>0)&&e.jsx(Xs,{paddingLeft:2,paddingRight:2,background:"neutral0",hasRadius:!0,borderColor:"neutral200",children:e.jsx(We,{"aria-label":f({id:r("bulk.select.label"),defaultMessage:"Select all folders & assets"}),checked:ye?"indeterminate":(E>0||T>0)&&R.length===E+T,onCheckedChange:d=>be(d,[...q,...W])})}),n&&L&&e.jsx(as,{value:i?.sort,onChangeSort:ve}),n&&e.jsx(qs,{})]}),endActions:e.jsxs(e.Fragment,{children:[u?e.jsx(_e,{paddingTop:1,paddingBottom:1,children:e.jsx(H,{tag:Yt,to:{pathname:`${x}/configuration`,search:Je.stringify(i,{encode:!1})},label:f({id:"app.links.configure-view",defaultMessage:"Configure the view"}),children:e.jsx(es,{})})}):null,e.jsx(_e,{paddingTop:1,paddingBottom:1,children:e.jsx(H,{label:f(L?{id:r("view-switch.list"),defaultMessage:"List View"}:{id:r("view-switch.grid"),defaultMessage:"Grid View"}),onClick:()=>ae(L?K.LIST:K.GRID),children:L?e.jsx(ts,{}):e.jsx(ss,{})})}),e.jsx(ys,{label:f({id:r("search.label"),defaultMessage:"Search for an asset"}),trackedEvent:"didSearchMediaLibraryElements",trackedEventDetails:{location:"upload"}})]})}),e.jsxs(Y.Content,{children:[R.length>0&&e.jsx(Gs,{currentFolder:ne,selected:R,onSuccess:at}),T===0&&E===0&&e.jsx(Ws,{canCreate:s,canRead:n,isFiltering:S,onActionClick:J}),n&&!L&&(E>0||T>0)&&e.jsx(ns,{assetCount:E,folderCount:T,indeterminate:ye,onChangeSort:ve,onChangeFolder:(d,V)=>t(G(x,i,{folder:d.toString(),folderPath:V})),onEditAsset:de,onEditFolder:Ae,onSelectOne:re,onSelectAll:be,rows:[...W,...q],selected:R,shouldDisableBulkSelect:!a,sortQuery:i?.sort??""}),n&&L&&e.jsxs(e.Fragment,{children:[T>0&&e.jsx(is,{title:(S&&E>0||!S)&&f({id:r("list.folders.title"),defaultMessage:"Folders ({count})"},{count:T})||"",children:W.map(d=>{const nt=!!R.filter(({type:ce})=>ce==="folder").find(ce=>ce.id===d.id),we=G(x,i,{folder:d?.id.toString(),folderPath:d?.path});return e.jsx($.Item,{col:3,direction:"column",alignItems:"stretch",children:e.jsx(os,{ref:le&&d.id===le.id?j:void 0,ariaLabel:d.name,id:`folder-${d.id}`,to:we,startAction:d.isSelectable?e.jsx(Us,{"data-testid":`folder-checkbox-${d.id}`,checked:nt,onCheckedChange:()=>re(d)}):null,cardActions:e.jsx(H,{label:f({id:r("list.folder.edit"),defaultMessage:"Edit folder"}),onClick:()=>Ae(d),children:e.jsx(Ge,{})}),children:e.jsx(ds,{children:e.jsx(ls,{to:we,children:e.jsxs(F,{tag:"h2",direction:"column",alignItems:"start",maxWidth:"100%",children:[e.jsxs(Re,{fontWeight:"semiBold",textColor:"neutral800",ellipsis:!0,children:[d.name,e.jsx(rs,{children:":"})]}),e.jsx(Re,{tag:"span",textColor:"neutral600",variant:"pi",ellipsis:!0,children:f({id:r("list.folder.subtitle"),defaultMessage:"{folderCount, plural, =0 {# folder} one {# folder} other {# folders}}, {filesCount, plural, =0 {# asset} one {# asset} other {# assets}}"},{folderCount:d.children?.count,filesCount:d.files?.count})})]})})})})},`folder-${d.id}`)})}),E>0&&T>0&&e.jsx(w,{paddingTop:6,paddingBottom:4,children:e.jsx(cs,{})}),E>0&&e.jsx(us,{assets:q,onEditAsset:de,onSelectAsset:re,selectedAssets:R.filter(({type:d})=>d==="asset"),title:(!S||S&&T>0)&&c?.pagination?.page===1&&f({id:r("list.assets.title"),defaultMessage:"Assets ({count})"},{count:Ye})||""})]}),e.jsxs(ue.Root,{...c?.pagination,children:[e.jsx(ue.PageSize,{}),e.jsx(ue.Links,{})]})]})]}),ie&&(m?e.jsx(Bs,{open:ie,onClose:J,folderId:i?.folder?Number(i.folder):null}):e.jsx(ps,{open:ie,onClose:J,trackedLocation:"upload",folderId:i?.folder})),he&&e.jsx(gs,{open:he,onClose:()=>st(),folder:le,parentFolderId:i?.folder,location:"upload"}),oe&&e.jsx(hs,{onClose:d=>{d===null&&Me(1),de(void 0)},open:!!oe,asset:oe,canUpdate:a,canCopyLink:l,canDownload:o,trackedLocation:"upload"})]})},Ks=y.lazy(async()=>js(()=>import("./ConfigureTheView-CNeCMPrC.js"),__vite__mapDeps([0,1,2])).then(t=>({default:t.ConfigureTheView}))),ta=()=>{const{config:{isLoading:t,isError:n,data:s}}=xs(),[{rawQuery:a},l]=se(),{formatMessage:o}=v(),u=o({id:r("plugin.name"),defaultMessage:"Media Library"});return y.useEffect(()=>{t||n||a||l({sort:s.sort,page:1,pageSize:s.pageSize})},[t,n,s,a,l]),t?e.jsx(P.Loading,{}):e.jsxs(P.Main,{children:[e.jsx(P.Title,{children:u}),a?e.jsx(y.Suspense,{fallback:e.jsx(P.Loading,{}),children:e.jsxs(ms,{children:[e.jsx(Ee,{index:!0,element:e.jsx(Zs,{})}),e.jsx(Ee,{path:"configuration",element:e.jsx(Ks,{config:s})})]})}):null]})};export{ta as Upload};
